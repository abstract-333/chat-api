networks:
  storages:
    driver: bridge

  server:
    driver: bridge

  loki:
    driver: bridge

services:
  main-app:
    build:
      context: ..
      dockerfile: ${DOCKERFILE}
    container_name: main-app
    ports:
      - "${API_PORT}:8000"
    env_file:
      - ../.env
    volumes:
      - ${APP_VOLUME:-/dev/null}:/app/    # If APP_VOLUME is empty, mount /dev/null
      - /app/.venv
    networks:
      - storages
      - server
      - loki
